<!DOCTYPE html>
<html>
<body>

	<h2>The XMLHttpRequest Object</h2>

	<h3>Start typing a name in the input field below:</h3>

	<p>
		iataCode for Departure: <input id="txt1" />
		<button id="btn">Get</button>
		<!-- onkeyup="showHint(this.value)"> -->
	</p>

	<div id="txtHint"></div>

	<script>
		
		document.getElementById('btn').onclick = function() {
			getAirLine(document.getElementById('txt1').value);
		}
		function getAirLine(str) {
			var xhttp;
			xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
					var datas = JSON.parse(this.responseText);
					console.log(datas);
					var innerHtml = "<table border='1'><th>No</th><th>airline.name</th><th>departure.iataCode</th><th>departure.scheduledTime</th>"
							+ "<th>departure.gate</th><th>departure.terminal</th><th>arrival.iataCode</th><th>arrival.scheduledTime</th><th>flight.number</th><th>flight.iataNumber</th></tr>"
					for (var i = 0; i < datas.length; i++) {
						innerHtml += "<tr><td>" + i + "</td><td>"
								+ datas[i].airline.name + "</td><td>"
								+ datas[i].departure.iataCode + "</td><td>"
								+ datas[i].departure.scheduledTime
								+ "</td><td>" + datas[i].departure.gate
								+ "</td><td>" + datas[i].departure.terminal
								+ "</td><td>" + datas[i].arrival.iataCode
								+ "</td><td>" + datas[i].arrival.scheduledTime
								+ "</td><td>" + datas[i].flight.number
								+ "</td><td>" + datas[i].flight.iataNumber
								+ "</td></tr>";
					}
					innerHtml += "</table>";
					document.getElementById("txtHint").innerHTML = innerHtml;
				}
			};
			xhttp.open("GET",
					"http://aviation-edge.com/api/public/timetable?key=91d2fc-100a8e-b99352-1e7a4c-f93561&iataCode="
							+ str + "&type=departure", true);
			xhttp.send();
		}
	</script>

</body>
</html>
